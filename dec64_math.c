/*
dec64_math.c
Elementary functions for DEC64.

dec64.com
2019-09-03
Public Domain

No warranty.

This file is a placeholder. It should be replaced with functions that are
faster and more accurate.
*/

#include <assert.h>
#include <limits.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include "dec64.h"

#define D_2                           0x200LL
#define D_E              0x6092A113D8D574F0LL
#define D_HALF                        0x5FFLL
#define D_HALF_PI        0x37CE4F32BB21A6F0LL
#define D_NHALF_PI       0xC831B0CD44DE59F0LL
#define D_NPI            0x9063619A89BCB4F0LL
#define D_PI             0x6F9C9E6576434CF0LL
#define D_2PI            0x165286144ADA42F1LL

#define FAC              93

dec64 factorials[FAC] = {
    (1LL << 8) + 0,
    (1LL << 8) + 0,
    (2LL << 8) + 0,
    (6LL << 8) + 0,
    (24LL << 8) + 0,
    (120LL << 8) + 0,
    (720LL << 8) + 0,
    (5040LL << 8) + 0,
    (40320LL << 8) + 0,
    (362880LL << 8) + 0,
    (3628800LL << 8) + 0,
    (39916800LL << 8) + 0,
    (479001600LL << 8) + 0,
    (6227020800LL << 8) + 0,
    (87178291200LL << 8) + 0,
    (1307674368000LL << 8) + 0,
    (20922789888000LL << 8) + 0,
    (355687428096000LL << 8) + 0,
    (6402373705728000LL << 8) + 0,
    (12164510040883200LL << 8) + 1,
    (24329020081766400LL << 8) + 2,
    (5109094217170944LL << 8) + 4,
    (11240007277776077LL << 8) + 5,
    (25852016738884977LL << 8) + 6,
    (6204484017332394LL << 8) + 8,
    (15511210043330986LL << 8) + 9,
    (4032914611266056LL << 8) + 11,
    (10888869450418352LL << 8) + 12,
    (30488834461171386LL << 8) + 13,
    (8841761993739702LL << 8) + 15,
    (26525285981219106LL << 8) + 16,
    (8222838654177923LL << 8) + 18,
    (26313083693369353LL << 8) + 19,
    (8683317618811886LL << 8) + 21,
    (29523279903960414LL << 8) + 22,
    (10333147966386145LL << 8) + 24,
    (3719933267899012LL << 8) + 26,
    (13763753091226345LL << 8) + 27,
    (5230226174666011LL << 8) + 29,
    (20397882081197443LL << 8) + 30,
    (8159152832478977LL << 8) + 32,
    (33452526613163807LL << 8) + 33,
    (14050061177528799LL << 8) + 35,
    (6041526306337384LL << 8) + 37,
    (26582715747884488LL << 8) + 38,
    (11962222086548019LL << 8) + 40,
    (5502622159812089LL << 8) + 42,
    (25862324151116818LL << 8) + 43,
    (12413915592536073LL << 8) + 45,
    (6082818640342676LL << 8) + 47,
    (30414093201713378LL << 8) + 48,
    (15511187532873823LL << 8) + 50,
    (8065817517094388LL << 8) + 52,
    (4274883284060026LL << 8) + 54,
    (23084369733924138LL << 8) + 55,
    (12696403353658276LL << 8) + 57,
    (7109985878048635LL << 8) + 59,
    (4052691950487722LL << 8) + 61,
    (23505613312828786LL << 8) + 62,
    (13868311854568984LL << 8) + 64,
    (8320987112741390LL << 8) + 66,
    (5075802138772248LL << 8) + 68,
    (31469973260387938LL << 8) + 69,
    (19826083154044401LL << 8) + 71,
    (12688693218588416LL << 8) + 73,
    (8247650592082471LL << 8) + 75,
    (5443449390774431LL << 8) + 77,
    (3647111091818869LL << 8) + 79,
    (24800355424368306LL << 8) + 80,
    (17112245242814131LL << 8) + 82,
    (11978571669969892LL << 8) + 84,
    (8504785885678623LL << 8) + 86,
    (6123445837688609LL << 8) + 88,
    (4470115461512684LL << 8) + 90,
    (33078854415193864LL << 8) + 91,
    (24809140811395398LL << 8) + 93,
    (18854947016660503LL << 8) + 95,
    (14518309202828587LL << 8) + 97,
    (11324281178206298LL << 8) + 99,
    (8946182130782975LL << 8) + 101,
    (7156945704626380LL << 8) + 103,
    (5797126020747368LL << 8) + 105,
    (4753643337012842LL << 8) + 107,
    (3945523969720659LL << 8) + 109,
    (33142401345653533LL << 8) + 110,
    (28171041143805503LL << 8) + 112,
    (24227095383672732LL << 8) + 114,
    (21077572983795277LL << 8) + 116,
    (18548264225739844LL << 8) + 118,
    (16507955160908461LL << 8) + 120,
    (14857159644817615LL << 8) + 122,
    (1352001527678403LL << 8) + 124,
    (12438414054641307LL << 8) + 126
};

dec64 dec64_acos(dec64 slope) {
    dec64 result = dec64_subtract(
        D_HALF_PI,
        dec64_asin(slope)
    );
    return result;
}

dec64 dec64_asin(dec64 slope) {
    if (dec64_is_equal(slope, DEC64_ONE) == DEC64_TRUE) {
        return D_HALF_PI;
    }
    if (dec64_is_equal(slope, DEC64_NEGATIVE_ONE) == DEC64_TRUE) {
        return D_NHALF_PI;
    }
    if (
        dec64_is_nan(slope) == DEC64_TRUE ||
        dec64_is_less(DEC64_ONE, dec64_abs(slope)) == DEC64_TRUE
    ) {
        return DEC64_NAN;
    }
    dec64 bottom = D_2;
    dec64 factor = slope;
    dec64 x2 = dec64_multiply(slope, slope);
    dec64 result = factor;
    while (1) {
        factor = dec64_divide(
            dec64_multiply(
                dec64_multiply(dec64_add(DEC64_NEGATIVE_ONE, bottom), x2),
                factor
            ),
            bottom
        );
        dec64 progress = dec64_add(
            result,
            dec64_divide(factor, dec64_add(DEC64_ONE, bottom))
        );
        if (result == progress) {
            break;
        }
        result = progress;
        bottom = dec64_add(bottom, D_2);
    }
    return result;
}

dec64 dec64_atan(dec64 x) {
    int rev = 0, neg = 0;
    if (x < 0) {
        x = dec64_neg(x);
        neg = 1;
    }
    if (dec64_is_less(DEC64_ONE, x) == DEC64_TRUE) {
        x = dec64_divide(DEC64_ONE, x);
        rev = 1;
    }

    dec64 a = dec64_asin(
        dec64_divide(
            x,
            dec64_sqrt(dec64_add(DEC64_ONE, dec64_multiply(x, x)))
        )
    );
    if (rev) a = dec64_subtract(D_HALF_PI, a);
    if (neg) a = dec64_neg(a);
    return a;
}

dec64 dec64_atan2(dec64 y, dec64 x) {
    if (dec64_is_zero(x) == DEC64_TRUE) {
        if (dec64_is_zero(y) == DEC64_TRUE) {
            return DEC64_NAN;
        } else if (y < 0) {
            return D_NHALF_PI;
        } else {
            return D_HALF_PI;
        }
    } else {
        dec64 atan = dec64_atan(dec64_divide(y, x));
        if (x < 0) {
            if (y < 0) {
                return dec64_subtract(atan, D_HALF_PI);
            } else {
                return dec64_add(atan, D_HALF_PI);
            }
        } else {
            return atan;
        }
    }
}

dec64 dec64_cos(dec64 radians) {
    return dec64_sin(dec64_add(radians, D_HALF_PI));
}

#define DEC64_EXP_N 256
// exp(-i*log(10)/256), i=0..256
static const dec64 exptab[DEC64_EXP_N+1] = {
    2560000000000000240, 2537077391997084144, 2514360036321377008, 2491846095114035952,
    2469533746972670192, 2447421186803987696, 2425506625677761264, 2403788290682102256,
    2382264424780029680, 2360933286667324400, 2339793150631655920, 2318842306412969200,
    2298079059065124592, 2277501728818772976, 2257108650945461744, 2236898175622956272,
    2216868667801767664, 2197018507072874224, 2177346087536630512, 2157849817672847344,
    2138528120212035312, 2119379432007803376, 2100402203910397936, 2081594900641374704,
    2062956000669393648, 2044483996087124976, 2026177392489257456, 2008034708851600368,
    1990054477411266288, 1972235243547927792, 1954575565666136816, 1937074015078697968,
    1919729175891087088, 1902539644886902512, 1885504031414343920, 1868620957273707504,
    1851889056605887728, 1835306975781876976, 1818873373293257712, 1802586919643670512,
    1786446297241257968, 1770450200292069616, 1754597334694421488, 1738886417934201840,
    1723316178981115632, 1707885358185854960, 1692592707178193136, 1677436988765989872,
    1662416976835101168, 1647531456250185712, 1632779222756397808, 1618159082881963760,
    1603669853841627376, 1589310363440961008, 1575079449981535472, 1560975962166935792,
    1546998759009620208, 1533146709738614256, 1519418693708028656, 1505813600306398960,
    1492330328866835184, 1478967788577976816, 1465724898395745264, 1452600586955886064,
    1439593792487293936, 1426703462726115056, 1413928554830617584, 1401268035296823792,
    1388720879874899696, 1376286073486291440, 1363962610141604336, 1351749492859217392,
    1339645733584626672, 1327650353110509552, 1315762380997507568, 1303980855495714800,
    1292304823466872816, 1280733340307259888, 1269265469871272176, 1257900284395687664,
    1246636864424609776, 1235474298735082480, 1224411684263370736, 1213448126031902192,
    1202582737076862192, 1191814638376437488, 1181142958779703024, 1170566834936143856,
    1160085411225809648, 1149697839690094320, 1139403279963135216, 1129200899203825904,
    1119089872028439280, 1109069380443852784, 1099138613781371632, 1089296768631145456,
    1079543048777170672, 1069876665132877040, 1060296835677287920, 1050802785391755504,
    1041393746197260272, 1032068956892272880, 1022827663091171056, 1013669117163210992,
    1004592578172041456, 995597311815761392, 986682590367515376, 977847692616618480,
    969091903810209520, 960414515595427824, 951814825962105584, 943292139185975536,
    934845765772384752, 926475022400515056, 9181792318681008367, 9099577230366433519,
    9018098307771139823, 8937348959161452527, 8857322651827027183, 8778012911552347375,
    8699413322092952303, 8621517524656357103, 8544319217387618799, 8467812154859509487,
    8391990147567254255, 8316847061427793903, 8242376817283530479, 8168573390410516975,
    8095430810031051247, 8022943158830632687, 7951104572479244783, 7879909239156926191,
    7809351399083585519, 7739425344053031663, 7670125416971171567, 7601446011398345711,
    7533381571095761647, 7465926589575987951, 7399075609657472495, 7332823223023052271,
    7267164069782412527, 7202092838038467567, 7137604263457621487, 7073693128843878383,
    7010354263716765167, 6947582543893034223, 6885372891072111087, 6823720272425254895,
    6762619700188397039, 6702066231258624751, 6642054966794279663, 6582581051818636015,
    6523639674827127279, 6465226067398090735, 6407335503806996207, 6349963300644131055,
    6293104816435705583, 6236755451268354287, 6180910646416996847, 6125565883976032751,
    6070716686493837807, 6016358616610532847, 5962487276698997743, 5909098308509096687,
    5856187392815093231, 5803750249066218223, 5751782635040369647, 5700280346500912367,
    5649239216856550127, 5598655116824243951, 5548523954095149039, 5498841673003542255,
    5449604254198714095, 5400807714319799535, 5352448105673518831, 5304521515914805743,
    5257024067730294255, 5209951918524638959, 5163301260109646319, 5117068318396186607,
    5071249353088867567, 5025840657383438319, 4980838557666907631, 4936239413220341487,
    4892039615924327919, 4848235589967074031, 4804823791555120111, 4761800708626642159,
    4719162860567323119, 4676906797928766191, 4635029102149432303, 4593526385278073071,
    4552395289699642607, 4511632487863663343, 4471234682015022575, 4431198603927181295,
    4391521014637770223, 4352198704186555375, 4313228491355747567, 4274607223412639215,
    4236331775854544623, 4198399052156024559, 4160805983518373359, 4123549528621349871,
    4086626673377132271, 4050034430686473967, 4013769840197044463, 3977829968063933423,
    3942211906712299759, 3906912774602145519, 3871929715995196143, 3837259900723867887,
    3802900523962304495, 3768848805999463663, 3735101992014235375, 3701657351852573679,
    3668512179806624751, 3635663794395831535, 3603109538149999343, 3570846777394303727,
    3538872902036223215, 3507185325354380015, 3475781483789271279, 3444658836735874543,
    3413814866338109679, 3383247077285142511, 3352952996609510127, 3322930173487055855,
    3293176179038654959, 3263688606133715695, 3234465069195439599, 3205503204007825391,
    3176800667524402415, 3148355137678674159, 3120164313196261871, 3092225913408728303,
    3064537678069069039, 3037097367168856303, 3009902760757020143, 2982951658760251375,
    2956241880805013231, 2929771266041147119, 2903537672967057903, 2877538979256462831,
    2851773081586694383, 2826237895468538095, 2800931355077595887, 2775851413087158255,
    2750996040502573039, 2726363226497098479, 2701950978249223919, 2677757320781449455,
    2653780296800507119, 2630017966539014639, 2606468407598545647, 2583129714794105583,
    2560000000000000239
};

dec64 dec64_exp(dec64 x0) {
    // x0 = n*10^e10, e^x0 = 10^(x0/log(10))
    // x = x0/log(10)
    // e10_ = ceil(x), x_ = x - e10_, -1 < x_ <= 0
    // e^x0 = 10^x = (10^x_) * 10^e10_ = e^(x_*log(10)) * 10^e10_
    dec64 log10 = (23025850929940457 << 8) | (-16 & 255);
    dec64 mlog10 = (-(23025850929940457 << 8)) | (-16 & 255);
    dec64 m256_div_log10 =
        (-(11117938736723247 << 8)) | (-14 & 255);
    dec64 log10_div_256 = (8994473019507991 << 8) | (-18 & 255);

    if (dec64_is_nan(x0) == DEC64_TRUE) return DEC64_NULL;
    dec64 x = dec64_divide(x0, log10);

    dec64 e10_ = dec64_normal(dec64_ceiling(x));
    int64 e = e10_ >> 8;
    if (e >= 200) return DEC64_NULL;
    if (e <= -200) return 0;
    dec64 y = dec64_fma(e10_, mlog10, x0);
    dec64 y_tab = dec64_multiply(y, m256_div_log10);
    y_tab = dec64_normal(dec64_floor(y_tab));
    int tab_idx = y_tab >> 8;
    tab_idx = tab_idx < 0 ? 0 : tab_idx > DEC64_EXP_N ? DEC64_EXP_N : tab_idx;
    y = dec64_fma(tab_idx << 8, log10_div_256, y);

    dec64 scale = exptab[tab_idx];
    dec64 p = scale, s = scale;
    int n = 1, max_iters = 30;

    for(;n < max_iters; n++) {
        p = dec64_multiply(p, dec64_divide(y, n*256));
        dec64 progress = dec64_add(s, p);
        if (dec64_is_equal(progress, s) == DEC64_TRUE)
            break;
        s = progress;
    }

    if (dec64_is_nan(s) == DEC64_TRUE)
        return DEC64_NULL;

    //printf("exp taylor iters=%d\n", n);
    return dec64_new(s >> 8, (signed char)s + e);
}

dec64 dec64_raise(dec64 coefficient, dec64 exponent) {
    if (dec64_is_zero(exponent) == DEC64_TRUE) {
        return DEC64_ONE;
    }

// Adjust for a negative exponent.

    if (exponent < 0) {
        coefficient = dec64_divide(DEC64_ONE, coefficient);
        exponent = dec64_neg(exponent);
    }
    if (dec64_is_nan(coefficient) == DEC64_TRUE) {
        return DEC64_NAN;
    }
    if (dec64_is_zero(coefficient) == DEC64_TRUE) {
        return 0;
    }

// If the exponent is an integer, then use the squaring method.

    if (exponent > 0 && dec64_exponent(exponent) == 0) {
        dec64 aux = DEC64_ONE;
        int64 n = dec64_coefficient(exponent);
        if (n <= 1) {
            return coefficient;
        }
        while (n > 1) {
            if ((n & 1) != 0) {
                aux = dec64_multiply(aux, coefficient);
            }
            coefficient = dec64_multiply(coefficient, coefficient);
            n /= 2;
        }
        return (n == 1)
            ? dec64_multiply(aux, coefficient)
            : aux;
    }

// Otherwise do it the hard way.

    return dec64_exp(dec64_multiply(
        dec64_log(coefficient),
        exponent
    ));
}

dec64 dec64_factorial(dec64 x) {
    dec64 n = dec64_normal(x);
    int64 c = dec64_coefficient(n);
    if (c >= 0 && c < FAC && dec64_exponent(n) == 0) {
        return factorials[c];
    }
    return DEC64_NAN;
}

#define LOGTAB_A -950
#define LOGTAB_B 1000
// log(1+i*0.001), i=LOGTAB_A..LOGTAB_B
static const dec64 logtab[] =
{
    -7669074620298216720,  -7618379894419996688,  -7568669594625816592,  -7519906215500838672,  -7472054354989728272,
    -7425080559999144976,  -7378953185912288528,  -7333642268537822224,  -7289119407195437072,  -7245357657795628816,
    -7202331434905692944,  -7160016421910593808,  -7118389488478836240,  -7077428614631947024,  -7037112820793510672,
    -6997422103261439504,  -6958337374606621200,  -6919840408553397520,  -6881913788943437584,  -6844540862425286672,
    -6807705694547911696,  -6771393028968503056,  -6735588249513168912,  -6700277344854389264,  -6665446875591596048,
    -6631083943541315856,  -6597176163061263120,  -6563711634248839952,  -6530678917868915728,  -6498067011878695696,
    -6465865329429133584,  -6434063678232827408,  -6402652241197782544,  -6371621558234979856,  -6340962509155387664,
    -6310666297579060496,  -6280724435785290768,  -6251128730438536208,  -6221871269130062096,  -6192944407679992592,
    -6164340758148792080,  -6136053177511134480,  -6108074756948727312,  -6080398811721935376,  -6053018871583060752,
    -6025928671696886032,  -5999122144036609808,  -5972593409225610512,  -5946336768797606416,  -5920346697849720336,
    -5894617838064756752,  -5869144991080646416,  -5843923112186536720,  -5818947304326403088,  -5794212812392356624,
    -5769715017791010832,  -5745449433267378704,  -5721411697971790864,  -5697597572756268304,  -5674002935687662864,
    -5650623777765685008,  -5627456198834695184,  -5604496403678828560,  -5581740698290678800,  -5559185486304362256,
    -5536827265584350480,  -5514662624961977104,  -5492688241112014864,  -5470900875562168848,  -5449297371828755472,
    -5427874652672232976,  -5406629717466613520,  -5385559639677133840,  -5364661564440881936,  -5343932706245376272,
    -5323370346700379664,  -5302971832398487056,  -5282734572860277008,  -5262656038560050704,  -5242733759028389904,
    -5222965321027979536,  -5203348366799322640,  -5183880592373161232,  -5164559745946581008,  -5145383626319937552,
    -5126350081391891216,  -5107457006709977360,  -5088702344074270736,  -5070084080191826704,  -5051600245379699728,
    -5033248912314451728,  -5015028194826159888,  -4996936246735043088,  -4978971260728908048,  -4961131467279708944,
    -4943415133597600272,  -4925820562620929296,  -4908346092040705808,  -4890990093358136080,  -4873750970973895184,
    -4856627161307855888,  -4839617131948064272,  -4822719380827803152,  -4805932435429635856,  -4789254852015379984,
    -4772685214880999184,  -4756222135635455760,  -4739864252502602000,  -4723610229645235472,  -4707458756510477840,
    -4691408547195673616,  -4675458339834045456,  -4659606895999367440,  -4643853000128958992,  -4628195458964322576,
    -4612633101008784144,  -4597164776001519888,  -4581789354407377424,  -4566505726921927696,  -4551312803991202576,
    -4536209515345600528,  -4521194809547461392,  -4506267653551830800,  -4491427032279956496,  -4476671948205076240,
    -4462001420950074640,  -4447414486896602128,  -4432910198805267984,  -4418487625446532624,  -4404145851241937936,
    -4389883975915332112,  -4375701114153756688,  -4361596395277674512,  -4347568962920232976,  -4333617974715267344,
    -4319742601993758992,  -4305942029488475408,  -4292215455046528784,  -4278562089349600528,  -4264981155641586192,
    -4251471889463426064,  -4238033538394898192,  -4224665361803149840,  -4211366630597763600,  -4198136626992150544,
    -4184974644271078928,  -4171879986564146448,  -4158851968625019920,  -4145889915616260368,  -4132993162899570192,
    -4120161055831296784,  -4107392949563036688,  -4094688208847186448,  -4082046207847294992,  -4069466329953076752,
    -4056947967599945744,  -4044490522092943120,  -4032093403434925840,  -4019756030158896656,  -4007477829164354320,
    -3995258235557550864,  -3983096692495540496,  -3970992651033918736,  -3958945569978142224,  -3946954915738330896,
    -3935020162187453968,  -3923140790522808080,  -3911316289130694160,  -3899546153454202640,  -3887829885864028432,
    -3876166995532225040,  -3864556998308823312,  -3852999416601235216,  -3841493779256366608,  -3830039621445368592,
    -3818636484550955024,  -3807283916057218832,  -3795981469441879824,  -3784728704070902288,  -3773525185095417104,
    -3762370483350890512,  -3751264175258479120,  -3740205842728517136,  -3729195073066077200,  -3718231458878554896,
    -3707314597985223696,  -3696444093328708880,  -3685619552888334864,  -3674840589595295504,  -3664106821249603344,
    -3653417870438772752,  -3642773364458193936,  -3632172935233153552,  -3621616219242466576,  -3611102857443673872,
    -3600632495199769616,  -3590204782207421712,  -3579819372426649104,  -3569475924011916304,  -3559174099244619024,
    -3548913564466919696,  -3538693990016903952,  -3528515050165026832,  -3518376423051818768,  -3508277790626817040,
    -3498218838588699664,  -3488199256326590736,  -3478218736862508048,  -3468276976794929936,  -3458373676243453968,
    -3448508538794519568,  -3438681271448175376,  -3428891584565862672,  -3419139191819193360,  -3409423810139701264,
    -3399745159669541648,  -3390102963713121040,  -3380496948689631760,  -3370926844086477584,  -3361392382413562384,
    -3351893299158431248,  -3342429332742236432,  -3333000224476517392,  -3323605718520773648,  -3314245561840810768,
    -3304919504167848208,  -3295627297958366736,  -3286368698354684176,  -3277143463146239760,  -3267951352731574544,
    -3258792130080991504,  -3249665560699881488,  -3240571412592699920,  -3231509456227582224,  -3222479464501583120,
    -3213481212706525200,  -3204514478495448080,  -3195579041849640464,  -3186674685046248976,  -3177801192626444304,
    -3168958351364140048,  -3160145950235249680,  -3151363780387469328,  -3142611635110578192,  -3133889309807245584,
    -3125196601964331792,  -3116533311124676112,  -3107899238859359504,  -3099294188740435216,  -3090717966314113296,
    -3082170379074395920,  -3073651236437148688,  -3065160349714604304,  -3056697532090285584,  -3048262598594343184,
    -3039855366079296784,  -3031475653196175888,  -3023123280371045904,  -3014798069781920016,  -3006499845336042256,
    -2998228432647539216,  -2989983659015431184,  -2981765353401995792,  -2973573346411478288,  -2965407470269142032,
    -2957267558800650000,  -2949153447411775504,  -2941064973068432144,  -2933001974277017872,  -2924964291065068560,
    -2916951764962213648,  -2908964238981430032,  -2901001557600585232,  -2893063566744269840,  -2885150113765907472,
    -2877261047430142736,  -2869396217895499024,  -2861555476697302032,  -2853738676730862608,  -2845945672234918672,
    -2838176318775324176,  -2830430473228989712,  -2822707993768059920,  -2815008739844334352,  -2807332572173917456,
    -2799679352722100496,  -2792048944688467728,  -2784441212492224528,  -2776856021757742608,  -2769293239300317968,
    -2761752733112140560,  -2754234372348467728,  -2746738027314001424,  -2739263569449464336,  -2731810871318370832,
    -2724379806593989648,  -2716970250046496528,  -2709582077530311184,  -2702215165971616272,  -2694869393356057104,
    -2687544638716614672,  -2680240782121654032,  -2672957704663142160,  -2665695288445030928,  -2658453416571808016,
    -2651231973137206288,  -2644030843213072656,  -2636849912838394640,  -2629689069008477712,  -2622548199664276752,
    -2615427193681872144,  -2608325940862095376,  -2601244331920296720,  -2594182258476252688,  -2587139613044214544,
    -2580116289023092240,  -2573112180686773008,  -2566127183174570768,  -2559161192481807376,  -2552214105450521104,
    -2545285819760299024,  -2538376233919236624,  -2531485247255015440,  -2524612759906102800,  -2517758672813068816,
    -2510922887710018832,  -2504105307116140560,  -2497305834327363088,  -2490524373408126224,  -2483760829183259152,
    -2477015107229966096,  -2470287113869916176,  -2463576756161438224,  -2456883941891816976,  -2450208579569689872,
    -2443550578417542928,  -2436909848364303632,  -2430286300038029072,  -2423679844758690576,  -2417090394531048208,
    -2410517862037618704,  -2403962160631734288,  -2397423204330686480,  -2390900907808961808,  -2384395186391559952,
    -2377905956047398672,  -2371433133382800400,  -2364976635635063056,  -2358536380666109968,  -2352112286956220176,
    -2345704273597836816,  -2339312260289453584,  -2332936167329576720,  -2326575915610762256,  -2320231426613726480,
    -2313902622401530384,  -2307589425613835024,  -2301291759461227536,  -2295009547719616784,  -2288742714724698128,
    -2282491185366485776,  -2276254885083909904,  -2270033739859483152,  -2263827676214026768,  -2257636621201465872,
    -2251460502403683088,  -2245299247925436688,  -2239152786389338896,  -2233021046930894352,  -2226903959193597968,
    -2220801453324090896,  -2214713459967374096,  -2208639910262080272,  -2202580735835799056,  -2196535868800458768,
    -2190505241747763472,  -2184488787744682256,  -2178486440328991760,  -2172498133504870928,  -2166523801738547216,
    -2160563379953993744,  -2154616803528676368,  -2148684008289348112,  -2142764930507896592,  -2136859506897234192,
    -2130967674607239440,  -2125089371220742672,  -2119224534749559824,  -2113373103630568464,  -2107535016721831952,
    -2101710213298765072,  -2095898633050344976,  -2090100216075363344,  -2084314902878723344,  -2078542634367775248,
    -2072783351848695568,  -2067036997022906640,  -2061303511983534352,  -2055582839211908624,  -2049874921574099728,
    -2044179702317495056,  -2038497125067414032,  -2032827133823758864,  -2027169672957703440,  -2021524687208419856,
    -2015892121679837456,  -2010271921837442320,  -2004664033505106704,  -1999068402861957136,  -1993484976439275024,
    -1987913701117430544,  -1982354524122850320,  -1976807393025019152,  -1971272255733511440,  -1965749060495057168,
    -1960237755890638352,  -1954738290832617232,  -1949250614561893392,  -1943774676645094928,  -1938310426971795472,
    -1932857815751763728,  -1927416793512241168,  -1921987311095248912,  -1916569319654922256,  -1911162770654874896,
    -1905767615865589008,  -1900383807361835280,  -1895011297520117008,  -1889650039016143376,  -1884299984822327568,
    -1878961088205312784,  -1873633302723522064,  -1868316582224733712,  -1863010880843684624,  -1857716152999693328,
    -1852432353394313744,  -1847159437009006608,  -1841897359102840848,  -1836646075210213904,  -1831405541138598160,
    -1826175712966309648,  -1820956547040298000,  -1815747999973961744,  -1810550028644983824,  -1805362590193188880,
    -1800185642018423568,  -1795019141778456336,  -1789863047386901008,  -1784717317011159056,  -1779581909070382864,
    -1774456782233459728,  -1769341895417016848,  -1764237207783443984,  -1759142678738938128,  -1754058267931566864,
    -1748983935249349392,  -1743919640818358800,  -1738865345000841744,  -1733821008393357072,  -1728786591824932368,
    -1723762056355239696,  -1718747363272787216,  -1713742474093130768,  -1708747350557100560,  -1703761954629047824,
    -1698786248495106064,  -1693820194561469968,  -1688863755452691984,  -1683916894009994000,  -1678979573289595664,
    -1674051756561059600,  -1669133407305651216,  -1664224489214715408,  -1659324966188068112,  -1654434802332402704,
    -1649553961959713808,  -1644682409585733392,  -1639820109928382992,  -1634967027906241296,  -1630123128637024272,
    -1625288377436081680,  -1620462739814907152,  -1615646181479661072,  -1610838668329708560,  -1606040166456171792,
    -1601250642140493840,  -1596470061853017616,  -1591698392251577104,  -1586935600180102416,  -1582181652667237904,
    -1577436516924971280,  -1572700160347277840,  -1567972550508776208,  -1563253655163395856,  -1558543442243057424,
    -1553841879856365840,  -1549148936287313680,  -1544464579993998608,  -1539788779607350800,  -1535121503929872144,
    -1530462721934387984,  -1525812402762809616,  -1521170515724906512,  -1516537030297093648,  -1511911916121223952,
    -1507295143003398160,  -1502686680912779792,  -1498086499980423440,  -1493494570498114576,  -1488910862917216784,
    -1484335347847531536,  -1479767996056167952,  -1475208778466421520,  -1470657666156663312,  -1466114630359239952,
    -1461579642459381776,  -1457052673994122256,  -1452533696651225360,  -1448022682268123152,  -1443519602830863376,
    -1439024430473065232,  -1434537137474884368,  -1430057696261988112,  -1425586079404537360,  -1421122259616180496,
    -1416666209753053456,  -1412217902812789008,  -1407777311933535760,  -1403344410392984336,  -1398919171607402768,
    -1394501569130680080,  -1390091576653377808,  -1385689168001789712,  -1381294317137010192,  -1376906998154009360,
    -1372527185280718096,  -1368154852877118224,  -1363789975434343696,  -1359432527573785616,  -1355082484046208528,
    -1350739819730871824,  -1346404509634659344,  -1342076528891216144,  -1337755852760093456,  -1333442456625899536,
    -1329136315997458448,  -1324837406506975248,  -1320545703909209360,  -1316261184080653328,  -1311983823018720272,
    -1307713596840935952,  -1303450481784139280,  -1299194454203688720,  -1294945490572675856,  -1290703567481144336,
    -1286468661635316496,  -1282240749856825616,  -1278019809081955088,  -1273805816360882960,  -1269598748856934160,
    -1265398583845836816,  -1261205298714986512,  -1257018870962715920,  -1252839278197569552,  -1248666498137585936,
    -1244500508609584912,  -1240341287548460048,  -1236188812996477712,  -1232043063102582288,  -1227904016121704464,
    -1223771650414079248,  -1219645944444565008,  -1215526876781971216,  -1211414426098390544,  -1207308571168535824,
    -1203209290869082896,  -1199116564178018320,  -1195030370173993744,  -1190950688035682064,  -1186877497041142800,
    -1182810776567190032,  -1178750506088764944,  -1174696665178315536,  -1170649233505179664,  -1166608190834972176,
    -1162573517028979984,  -1158545192043557904,  -1154523195929532432,  -1150507508831608592,  -1146498110987781392,
    -1142494982728753680,  -1138498104477355280,  -1134507456747970064,  -1130523020145965072,  -1126544775367125264,
    -1122572703197093136,  -1118606784510809872,  -1114647000271965200,  -1110693331532447504,  -1106745759431800336,
    -1102804265196682768,  -1098868830140333328,  -1094939435662039056,  -1091016063246607120,  -1087098694463842064,
    -1083187310968025616,  -1079281894497402640,  -1075382426873667600,  -1071488890001458704,  -1067601265867852048,
    -1063719536541864208,  -1059843684173953808,  -1055973690995529488,  -1052109539318462480,  -1048251211534599952,
    -1044398690115283984,  -1040551957610874384,  -1036710996650273808,  -1032875789940457488,  -1029046320266005776,
    -1025222570488640528,  -1021404523546765328,  -1017592162455007760,  -1013785470303767312,  -1009984430258764560,
    -1006189025560594192,  -1002399239524282640,  -998615055538846736,  -994836457066858000,  -991063427644008464,
    -987295950878680592,  -983534010451518992,  -979777590115007760,  -976026673693048080,  -972281245080541456,
    -968541288242973968,  -964806787216004368,  -961077726105056272,  -957354089084910864,  -953635860399304720,
    -949923024360529680,  -946215565349035792,  -942513467813036560,  -938816716268118288,  -935125295296851216,
    -931439189548402704,  -927758383738156304,  -924082862647329552,  -9204126111225973009,  -9167476140757165841,
    -9130878564831548689,  -9094333233857201937,  -9057839998881943569,  -9021398711589686801,  -8985009224296822801,
    -8948671389948630801,  -8912385062115711249,  -8876150094990445841,  -8839966343383482385,  -8803833662720244241,
    -8767751909037464081,  -8731720938979741969,  -8695740609796128785,  -8659810779336732433,  -8623931306049348113,
    -8588102048976112401,  -8552322867750180625,  -8516593622592427025,  -8480914174308169233,  -8445284384283912977,
    -8409704114484122897,  -8374173227448012049,  -8338691586286356753,  -8303259054678332433,  -8267875496868369425,
    -8232540777663034129,  -8197254762427928337,  -8162017317084612625,  -8126828308107547409,  -8091687602521059601,
    -8056595067896325905,  -8021550572348378641,  -7986553984533132305,  -7951605173644430097,  -7916704009411109393,
    -7881850362094089489,  -7847044102483476497,  -7812285101895691281,  -7777573232170612497,  -7742908365668742929,
    -7708290375268392977,  -7673719134362883857,  -7639194516857768721,  -7604716397168073745,  -7570284650215556625,
    -7535899151425984785,  -7501559776726430481,  -7467266402542585361,  -7433018905796090897,  -7398817163901889553,
    -7364661054765591569,  -7330550456780858897,  -7296485248826808849,  -7262465310265432593,  -7228490520939032849,
    -7194560761167675921,  -7160675911746663441,  -7126835853944019729,  -7093040469497993745,  -7059289640614582289,
    -7025583249965063185,  -6991921180683550993,  -6958303316364563729,  -6924729541060609041,  -6891199739279783697,
    -6857713795983390737,  -6824271596583570961,  -6790873026940950033,  -6757517973362300945,  -6724206322598222609,
    -6690937961840832273,  -6657712778721473297,  -6624530661308438289,  -6591391498104706065,  -6558295178045694225,
    -6525241590497025297,  -6492230625252308241,  -6459262172530933777,  -6426336122975883281,  -6393452367651552785,
    -6360610798041590289,  -6327811306046747665,  -6295053783982744593,  -6262338124578148881,  -6229664220972267281,
    -6197031966713052433,  -6164441255755020817,  -6131891982457185553,  -6099384041581002769,  -6066917328288327697,
    -6034491738139388433,  -6002107167090769169,  -5969763511493406481,  -5937460668090599953,  -5905198534016033809,
    -5872977006791811601,  -5840795984326503185,  -5808655364913203217,  -5776555047227603985,  -5744494930326076689,
    -5712474913643769617,  -5680494896992712209,  -5648554780559937297,  -5616654464905609489,  -5584793850961169169,
    -5552972840027485969,  -5521191333773024017,  -5489449234232018961,  -5457746443802666513,  -5426082865245320977,
    -5394458401680706321,  -5362872956588137489,  -5331326433803752721,  -5299818737518757137,  -5268349772277676561,
    -5236919442976622865,  -5205527654861568785,  -5174174313526634513,  -5142859324912383761,  -5111582595304131089,
    -5080344031330258961,  -5049143539960545809,  -5017981028504502545,  -4986856404609721105,  -4955769576260232721,
    -4924720451774875153,  -4893708939805669905,  -4862734949336210705,  -4831798389680060177,  -4800899170479157009,
    -4770037201702231825,  -4739212393643234577,  -4708424656919768337,  -4677673902471535377,  -4646960041558791185,
    -4616282985760807953,  -4585642646974346769,  -4555038937412140049,  -4524471769601382417,  -4493941056382230033,
    -4463446710906310161,  -4432988646635238161,  -4402566777339144209,  -4372181017095208721,  -4341831280286206225,
    -4311517481599057937,  -4281239536023392273,  -4250997358850115857,  -4220790865669989649,  -4190619972372217105,
    -4160484595143037457,  -4130384650464330513,  -4100320055112225553,  -4070290726155722769,  -4040296580955319825,
    -4010337537161646609,  -3980413512714110481,  -3950524425839545617,  -3920670195050873873,  -3890850739145770769,
    -3861065977205340945,  -3831315828592799761,  -3801600212952164881,  -3771919050206952977,  -3742272260558884369,
    -3712659764486597649,  -3683081482744368401,  -3653537336360836881,  -3624027246637743889,  -3594551135148672017,
    -3565108923737795601,  -3535700534518636817,  -3506325889872829713,  -3476984912448891921,  -3447677525161000465,
    -3418403651187778833,  -3389163213971087377,  -3359956137214822417,  -3330782344883721745,  -3301641761202177041,
    -3272534310653053201,  -3243459917976512785,  -3214418508168850961,  -3185410006481331985,  -3156434338419036433,
    -3127491429739712785,  -3098581206452635921,  -3069703594817473297,  -3040858521343154705,  -3012045912786750993,
    -2983265696152358929,  -2954517798689989905,  -2925802147894468113,  -2897118671504332817,  -2868467297500746257,
    -2839847954106410769,  -2811260569784488209,  -2782705073237527569,  -2754181393406398481,  -2725689459469229329,
    -2697229200840353041,  -2668800547169257745,  -2640403428339542545,  -2612037774467881489,  -2583703515902990097,
    -2555400583224599569,  -2527128907242437393,  -2498888418995211281,  -2470679049749600017,  -2442500730999250193,
    -2414353394463777809,  -2386236972087775249,  -2358151396039824657,  -2330096598711515409,  -2302072512716467985,
    -2274079070889362705,  -2246116206284973329,  -2218183852177208081,  -2190281942058152465,  -2162410409637119761,
    -2134569188839706897,  -2106758213806853137,  -2078977418893906193,  -2051226738669692945,  -2023506107915593745,
    -1995815461624623377,  -1968154735000516113,  -1940523863456816401,  -1912922782615973649,  -1885351428308442129,
    -1857809736571786769,  -1830297643649791249,  -1802815085991574033,  -1775362000250706449,  -1747938323284337169,
    -1720543992152321041,  -1693178944116351761,  -1665843116639100177,  -1638536447383356689,  -1611258874211177745,
    -1584010335183038993,  -1556790768556989713,  -1529600112787813905,  -1502438306526196497,  -1475305288617890577,
    -1448200998102893841,  -1421125374214624529,  -1394078356379105297,  -1367059884214150161,  -1340069897528555025,
    -1313108336321293329,  -1286175140780716561,  -1259270251283756305,  -1232393608395134225,  -1205545152866573329,
    -1178724825636013841,  -1151932567826835473,  -1125168320747079185,  -1098432025888678417,  -1071723624926689809,
    -1045043059718531089,  -1018390272303220497,  -991765204900622097,  -965167799910694161,  -938597999912740625,
    -9120557476646688018,  -8855409861022477842,  -8590536583383737618,  -8325937076623368978,  -8061610775390929682,
    -7797557116085387538,  -7533775536847907858,  -7270265477554681618,  -7007026379809789202,  -6744057686938099474,
    -6481358843978207762,  -6218929297675408658,  -5956768496474703634,  -5694875890513847314,  -5433250931616427282,
    -5171893073284978450,  -4910801770694135826,  -4649976480683817746,  -4389416661752447762,  -4129121774050208786,
    -3869091279372331538,  -3609324641152418322,  -3349821324455799826,  -3090580795972924434,  -2831602524012783890,
    -2572885978496368658,  -2314430630950159634,  -2056235954499650066,  -1798301423862901522,  -1540626515344131858,
    -1283210706827335954,  -1026053477769937170,  -7691543091964727571,  -5125126836923077907,  -2561280853973845523,
    237,  2558720852693845229,  5114886816443023597,  7668502988284105965,  1021957445001588206,
    1276810626826003182,  1531410349452151022,  1785757116524862190,  2039851430189279982,  2293693791096807662,
    2547284698411029486,  2800624649813597422,  3053714141510093550,  3306553668235860206,  3559143723261804014,
    3811484798400167918,  4063577384010278382,  4315421969004262382,  4567019040852736238,  4818369085590467054,
    5069472587822006766,  5320330030727297262,  5570941896067249390,  5821308664189294062,  6071430814032906990,
    6321308823135104494,  6570943167635914990,  6820334322283821806,  7069482760441181678,  7318388954089614318,
    7567053373835367406,  7815476488914655726,  8063658767198973934,  8311600675200382958,  8559302678076771566,
    8806765239637093614,  9053988822346577134,  930097388733191407,  954772089438640879,  979423030197512943,
    1004050256724001519,  1028653814600495087,  1053233749278084847,  1077790106077066223,  1102322930187442927,
    1126832266669423087,  1151318160453917935,  1175780656343035119,  1200219799010570991,  1224635633002499311,
    1249028202737459439,  1273397552507240431,  1297743726477264111,  1322066768687064559,  1346366723050767087,
    1370643633357563631,  1394897543272185327,  1419128496335375087,  1443336535964355823,  1467521705453297135,
    1491684047973780207,  1515823606575259887,  1539940424185525743,  1564034543611158767,  1588106007537987823,
    1612154858531544303,  1636181139037511919,  1660184891382177775,  1684166157772879599,  1708124980298449391,
    1732061400929659375,  1755975461519660271,  1779867203804422639,  1803736669403172591,  1827583899818827503,
    1851408936438428911,  1875211820533572591,  1898992593260838895,  1922751295662218735,  1946487968665539055,
    1970202653084885231,  1993895389621023727,  2017566218861818607,  2041215181282651375,  2064842317246834671,
    2088447667006025711,  2112031270700638959,  2135593168360253423,  2159133399904022767,  2182652005141079791,
    2206149023770939887,  2229624495383904751,  2253078459461460719,  2276510955376678895,  2299922022394610415,
    2323311699672682223,  2346680026261089263,  2370027041103185903,  2393352783035875823,  2416657290789998575,
    2439940602990716655,  2463202758157898735,  2486443794706502383,  2509663750946954991,  2532862665085531631,
    2556040575224733423,  2579197519363662575,  2602333535398395887,  2625448661122357231,  2648542934226687727,
    2671616392300615151,  2694669072831819503,  2717701013206800367,  2740712250711239407,  2763702822530362607,
    2786672765749301487,  2809622117353451759,  2832550914228829935,  2855459193162430191,  2878346990842577647,
    2901214343859281391,  2924061288704585455,  2946887861772917231,  2969694099361437167,  2992480037670383087,
    3015245712803416559,  3037991160767965423,  3060716417475565039,  3083421518742199279,  3106106500288639471,
    3128771397740779759,  3151416246629975279,  3174041082393374703,  3196645940374253295,  3219230855822344687,
    3241795863894169839,  3264340999653366255,  3286866298071014383,  3309371794025963247,  3331857522305154543,
    3354323517603944943,  3376769814526428143,  3399196447585753071,  3421603451204444399,  3443990859714717935,
    3466358707358796271,  3488707028289224431,  3511035856569181423,  3533345226172792047,  3555635170985437167,
    3577905724804062959,  3600156921337487343,  3622388794206707439,  3644601376945202671,  3666794702999240431,
    3688968805728175855,  3711123718404754927,  3733259474215411951,  3755376106260569839,  3777473647554935535,
    3799552131027796207,  3821611589523314159,  3843652055800819183,  3865673562535100911,  3887676142316699887,
    3909659827652195823,  3931624650964496623,  3953570644593124847,  3975497840794504175,  3997406271742243055,
    4019295969527417839,  4041166966158855663,  4063019293563414511,  4084852983586263535,  4106668067991160815,
    4128464578460730607,  4150242546596740847,  4172002003920375791,  4193742981872511215,  4215465511813987311,
    4237169625025879023,  4258855352709766639,  4280522725988005615,  4302171775903993327,  4323802533422437103,
    4345415029429619695,  4367009294733663215,  4388585360064793583,  4410143256075601903,  4431683013341306607,
    4453204662360013551,  4474708233552974319,  4496193757264845551,  4517661263763944175,  4539110783242504943,
    4560542345816934383,  4581955981528063983,  4603351720341404399,  4624729592147395055,  4646089626761656303,
    4667431853925238767,  4688756303304870383,  4710063004493205743,  4731351987009071087,  4752623280297710319,
    4773876913731029231,  4795112916607838959,  4816331318154098159,  4837532147523154159,  4858715433795984111,
    4879881205981433071,  4901029493016453359,  4922160323766341615,  4943273727024975087,  4964369731515047151,
    4985448365888301807,  5006509658725766895,  5027553638537987311,  5048580333765255407,  5069589772777842671,
    5090581983876229103,  5111556995291331567,  5132514835184731887,  5153455531648903919,  5174379112707439343,
    5195285606315272175,  5216175040358903535,  5237047442656624623,  5257902840958738671,  5278741262947783151,
    5299562736238749167,  5320367288379301615,  5341154946849997807,  5361925739064505839,  5382679692369819631,
    5403416834046477551,  5424137191308775407,  5444840791304981999,  5465527661117551855,  5486197827763338479,
    5506851318193805039,  5527488159295236335,  5548108377888947951,  5568712000731496175,  5589299054514885359,
    5609869565866776303,  5630423561350692079,  5650961067466224879,  5671482110649239791,  5691986717272080111,
    5712474913643770095,  5732946726010216943,  5753402180554413807,  5773841303396640239,  5794264120594661359,
    5814670658143928815,  5835060941977777647,  5855434997967625711,  5875792851923169007,  5896134529592579055,
    5916460056662697967,  5936769458759232495,  5957062761446948335,  5977339990229864175,  5997601170551441647,
    6017846327794779375,  6038075487282801903,  6058288674278451439,  6078485913984875247,  6098667231545615855,
    6118832652044797935,  6138982200507315439,  6159115901899018479,  6179233781126898671,  6199335863039273199,
    6219422172425970671,  6239492734018512623,  6259547572490297583,  6279586712456782575,  6299610178475664623,
    6319617995047060719,  6339610186613688303,  6359586777561044719,  6379547792217584367,  6399493254854897647,
    6419423189687888111,  6439337620874947823,  6459236572518134255,  6479120068663344111,  6498988133300488943,
    6518840790363667439,  6538678063731339759,  6558499977226499055,  6578306554616843247,  6598097819614946031,
    6617873795878427631,  6637634507010123759,  6657379976558255087,  6677110228016595439,  6696825284824639983,
    6716525170367771119,  6736209907977426671,  6755879520931264239,  6775534032453326831,  6795173465714207215,
    6814797843831212527,  6834407189868526831,  6854001526837373679,  6873580877696178415,  6893145265350729967,
    6912694712654340847,  6932229242408007663,  6951748877360571119,  6971253640208873967,  6990743553597920751,
    7010218640121033711,  7029678922320012015,  7049124422685286383,  7068555163656076527,  7087971167620545519,
    7107372456915955183,  7126759053828819951,  7146130980595060463,  7165488259400157167,  7184830912379301871,
    7204158961617549807,  7223472429149971951,  7242771336961804015,  7262055706988598255,  7281325561116372207,
    7300580921181757679,  7319821808972149487,  7339048246225853423,  7358260254632233711,  7377457855831858927,
    7396641071416649199,  7415809922930022127,  7434964431867037167,  7454104619674540015,  7473230507751307759,
    7492342117448192239,  7511439470068261871,  7530522586866945519,  7549591489052173551,  7568646197784519919,
    7587686734177342447,  7606713119296923375,  7625725374162609647,  7644723519746951663,  7663707576975842287,
    7682677566728655087,  7701633509838382319,  7720575427091772399,  7739503339229465583,  7758417266946131439,
    7777317230890604271,  7796203251666018287,  7815075349829941743,  7833933545894512367,  7852777860326570735,
    7871608313547792623,  7890424925934823151,  7909227717819408111,  7928016709488526575,  7946791921184521455,
    7965553373105230575,  7984301085404117231,  8003035078190400495,  8021755371529183471,  8040461985441583343,
    8059154939904859119,  8077834254852540143,  8096499950174553327,  8115152045717350639,  8133790561284034799,
    8152415516634486511,  8171026931485489391,  8189624825510855663,  8208209218341551087,  8226780129565818095,
    8245337578729301231,  8263881585335170031,  8282412168844240879,  8300929348675101935,  8319433144204232431,
    8337923574766126831,  8356400659653414383,  8374864418116980463,  8393314869366086895,  8411752032568492015,
    8430175926850570223,  8448586571297430255,  8466983984953034479,  8485368186820317679,  8503739195861303023,
    8522097030997221359,  8540441711108626927,  8558773255035514351,  8577091681577434095,  8595397009493609711,
    8613689257503051247,  8631968444284670959,  8650234588477397999,  8668487708680291823,  8686727823452656367,
    8704954951314152943,  8723169110744913135,  8741370320185651439,  8759558598037777135,  8777733962663505135,
    8795896432385969135,  8814046025489330159,  8832182760218888687,  8850306654781194223,  8868417727344154095,
    8886515996037144559,  8904601478951117551,  8922674194138710767,  8940734159614355695,  8958781393354383855,
    8976815913297135855,  8994837737343068143,  9012846883354857967,  9030843369157512431,  9048827212538471151,
    9066798431247714799,  9084757042997867503,  9102703065464303855,  9120636516285251823,  9138557413061897199,
    9156465773358487535,  9174361614702435055,  9192244954584419311,  9210115810458491119,  922797419974217456,
    924582013981656304,  926365364802643184,  928147474168033264,  929928343805068784,  931707975437391088,
    933486370785048048,  935263531564505840,  937039459488658928,  938814156266838768,  940587623604824560,
    942359863204852720,  944130876765626864,  945900665982328048,  947669232546623216,  949436578146676208,
    951202704467156720,  952967613189250288,  954731305990667248,  956493784545653744,  958255050524998896,
    960015105596047088,  961773951422705392,  963531589665453808,  965288021981354224,  967043250024060656,
    968797275443827696,  970550099887519984,  972301724998622448,  974052152417247728,  975801383780146928,
    977549420720718576,  979296264869017072,  981041917851762672,  982786381292349168,  984529656810855408,
    986271746024051184,  988012650545409520,  989752371985112560,  991490911950062832,  993228272043891184,
    994964453866964976,  996699459016399088,  998433289086061552,  1000165945666585840,  1001897430345376752,
    1003627744706620912,  1005356890331294192,  1007084868797171696,  1008811681678835440,  1010537330547683312,
    1012261816971937264,  1013985142516652784,  1015707308743726320,  1017428317211904496,  1019148169476792304,
    1020866867090861808,  1022584411603459824,  1024300804560817136,  1026016047506056688,  1027730141979201776,
    1029443089517183472,  1031154891653851120,  1032865549919977968,  1034575065843271152,  1036283440948379632,
    1037990676756901104,  1039696774787391984,  1041401736555374320,  1043105563573343984,  1044808257350779376,
    1046509819394148336,  1048210251206916848,  1049909554289557744,  1051607730139556848,  1053304780251422448,
    1055000706116692720,  1056695509223942640,  1058389191058793968,  1060081753103920624,  1061773196839058160,
    1063463523741011440,  1065152735283660784,  1066840832937971952,  1068527818172002032,  1070213692450907888,
    1071898457236953840,  1073582113989519088,  1075264664165105136,  1076946109217343728,  1078626450597003760,
    1080305689751999984,  1081983828127399408,  1083660867165428464,  1085336808305481712,  1087011652984128752,
    1088685402635121136,  1090358058689399792,  1092029622575103216,  1093700095717573616,  1095369479539365104,
    1097037775460251120,  1098704984897230064,  1100371109264534768,  1102036149973637872,  1103700108433260272,
    1105362986049377008,  1107024784225225712,  1108685504361312752,  1110345147855421168,  1112003716102616304,
    1113661210495254768,  1115317632422989552,  1116972983272778736,  1118627264428890864,  1120280477272913136,
    1121932623183757808,  1123583703537668848,  1125233719708229360,  1126882673066368240,  1128530564980366832,
    1130177396815865840,  1131823169935871984,  1133467885700765168,  1135111545468304880,  1136754150593637360,
    1138395702429301232,  1140036202325235440,  1141675651628785392,  1143314051684709616,  1144951403835185648,
    1146587709419818480,  1148222969775645424,  1149857186237142768,  1151490360136233456,  1153122492802292720,
    1154753585562154992,  1156383639740119536,  1158012656657958128,  1159640637634920688,  1161267583987741680,
    1162893497030647024,  1164518378075359984,  1166142228431107568,  1167765049404627440,  1169386842300173040,
    1171007608419521264,  1172627349061977840,  1174246065524383216,  1175863759101120496,  1177480431084119536,
    1179096082762864624,  1180710715424400112,  1182324330353336560,  1183936928831856880,  1185548512139722224,
    1187159081554279152,  1188768638350463728,  1190377183800809968,  1191984719175453680,  1193591245742139888,
    1195196764766228464,  1196801277510699760,  1198404785236161264,  1200007289200852464,  1201608790660652272,
    1203209290869083376,  1204808791077318896,  1206407292534189040,  1208004796486184944,  1209601304177466608,
    1211196816849866992,  1212791335742899184,  1214384862093761520,  1215977397137343216,  1217568942106230512,
    1219159498230711536,  1220749066738783728,  1222337648856157680,  1223925245806264048,  1225511858810258416,
    1227097489087027184,  1228682137853193456,  1230265806323122928,  1231848495708927984,  1233430207220475376,
    1235010942065389552,  1236590701449060336,  1238169486574646512,  1239747298643082992,  1241324138853084912,
    1242900008401154288,  1244474908481584368,  1246048840286466032,  1247621805005692656,  1249193803826964976,
    1250764837935798000,  1252334908515524848,  1253904016747303408,  1255472163810120176,  1257039350880796656,
    1258605579133994992,  1260170849742221808,  1261735163875834864,  1263298522703047152,  1264860927389933296,
    1266422379100434416,  1267982878996361968,  1269542428237405680,  1271101027981135600,  1272658679383010032,
    1274215383596378352,  1275771141772488176,  1277325955060488688,  1278879824607437040,  1280432751558302704,
    1281984737055972592,  1283535782241257200,  1285085888252893168,  1286635056227551216,  1288183287299839216,
    1289730582602307312,  1291276943265454064,  1292822370417730544,  1294366865185544432,  1295910428693267184,
    1297453062063237104,  1298994766415764208,  1300535542869136624,  1302075392539624176,  1303614316541483248,
    1305152315986962416,  1306689391986306544,  1308225545647761904,  1309760778077581040,  1311295090380027120,
    1312828483657379312,  1314360959009937392,  1315892517536025584,  1317423160331998704,  1318952888492246256,
    1320481703109196528,  1322009605273321968,  1323536596073144048,  1325062676595237104,  1326587847924233968,
    1328112111142829296,  1329635467331785456,  1331157917569936368,  1332679462934192880,  1334200104499545840,
    1335719843339072240,  1337238680523939312,  1338756617123408112,  1340273654204839664,  1341789792833697520,
    1343305034073554416,  1344819378986094832,  1346332828631120880,  1347845384066555888,  1349357046348448752,
    1350867816530979056,  1352377695666461168,  1353886684805348848,  1355394784996238576,  1356901997285875440,
    1358408322719156464,  1359913762339135472,  1361418317187027184,  1362921988302211312,  1364424776722237680,
    1365926683482829296,  1367427709617887984,  1368927856159497456,  1370427124137928176,  1371925514581641968,
    1373423028517295600,  1374919666969744624,  1376415430962049264,  1377910321515476464,  1379404339649505520,
    1380897486381832432,  1382389762728372720,  1383881169703266800,  1385371708318883056,  1386861379585823472,
    1388350184512926192,  1389838124107270384,  1391325199374180336,  1392811411317229296,  1394296760938243824,
    1395781249237307376,  1397264877212764912,  1398747645861226480,  1400229556177571824,  1401710609154952944,
    1403190805784800496,  1404670147056825072,  1406148633959023344,  1407626267477680880,  1409103048597376496,
    1410578978300985840,  1412054057569685744,  1413528287382958064,  1415001668718593008,  1416474202552694000,
    1417945889859680752,  1419416731612293360,  1420886728781596656,  1422355882336983024,  1423824193246177264,
    1425291662475239920,  1426758290988571120,  1428224079748914160,  1429689029717360112,  1431153141853350640,
    1432616417114682352,  1434078856457510128,  1435540460836351472,  1437001231204089584,  1438461168511977968,
    1439920273709642736,  1441378547745087984,  1442835991564698096,  1444292606113242608,  1445748392333878256,
    1447203351168154864,  1448657483556017136,  1450110790435809008,  1451563272744277232,  1453014931416575216,
    1454465767386266096,  1455915781585327088,  1457364974944152048,  1458813348391556592,  1460260902854779632,
    1461707639259489008,  1463153558529783280,  1464598661588196592,  1466042949355701488,  1467486422751712752,
    1468929082694090736,  1470370930099144688,  1471811965881636848,  1473252190954785008,  1474691606230267376,
    1476130212618224368,  1477568011027263216,  1479005002364461296,  1480441187535368944,  1481876567444013296,
    1483311142992902384,  1484744915083026928,  1486177884613865200,  1487610052483385584,  1489041419588050416,
    1490471986822819056,  1491901755081151472,  1493330725255011312,  1494758898234869488,  1496186274909707504,
    1497612856167020272,  1499038642892820464,  1500463635971640560,  1501887836286537200,  1503311244719094256,
    1504733862149424880,  1506155689456176880,  1507576727516534512,  1508996977206221552,  1510416439399505904,
    1511835114969201392,  1513253004786672112,  1514670109721834224,  1516086430643161328,  1517501968417684976,
    1518916723911000304,  1520330697987267568,  1521743891509216496,  1523156305338148080,  1524567940333939184,
    1525978797355044336,  1527388877258500336,  1528798180899927536,  1530206709133535216,  1531614462812122352,
    1533021442787082480,  1534427649908405744,  1535833085024682736,  1537237748983106800,  1538641642629477616,
    1540044766808204528,  1541447122362308592,  1542848710133426672,  1544249530961813488,  1545649585686345456,
    1547048875144524016,  1548447400172476912,  1549845161604962800,  1551242160275374320,  1552638397015739376,
    1554033872656726256,  1555428588027644912,  1556822543956451056,  1558215741269748208,  1559608180792791280,
    1560999863349489648,  1562390789762408688,  1563780960852774896,  1565170377440476912,  1566559040344069616,
    1567946950380775920,  1569334108366490864,  1570720515115783664,  1572106171441900784,  1573491078156769008,
    1574875236070998000,  1576258645993883120,  1577641308733408496,  1579023225096250352,  1580404395887778544,
    1581784821912060400,  1583164503971862768,  1584543442868656112,  1585921639402616048,  1587299094372626160,
    1588675808576281584,  1590051782809891312,  1591427017868481008,  1592801514545795824,  1594175273634302704,
    1595548295925194224,  1596920582208389616,  1598292133272539376,  1599662949905026544,  1601033032891970288,
    1602402383018228208,  1603771001067398896,  1605138887821825008,  1606506044062596080,  1607872470569550064,
    1609238168121277936,  1610603137495124464,  1611967379467192048,  1613330894812342512,  1614693684304200688,
    1616055748715156208,  1617417088816367088,  1618777705377761264,  1620137599168039664,  1621496770954678768,
    1622855221503933936,  1624212951580840688,  1625569961949218032,  1626926253371671024,  1628281826609593840,
    1629636682423170800,  1630990821571380464,  1632344244811997680,  1633696952901595888,  1635048946595549680,
    1636400226648037872,  1637750793812045296,  1639100648839365872,  1640449792480604656,  1641798225485181168,
    1643145948601330928,  1644492962576108016,  1645839268155388656,  1647184866083871984,  1648529757105084656,
    1649873941961380848,  1651217421393946864,  1652560196142802160,  1653902266946802928,  1655243634543643376,
    1656584299669858800,  1657924263060828400,  1659263525450776560,  1660602087572776688,  1661939950158752240,
    1663277113939480048,  1664613579644592368,  1665949348002579184,  1667284419740791280,  1668618795585441264,
    1669952476261607152,  1671285462493234416,  1672617755003138032,  1673949354513005552,  1675280261743397872,
    1676610477413753840,  1677940002242390768,  1679268836946507248,  1680596982242186224,  1681924438844395760,
    1683251207466993392,  1684577288822726384,  1685902683623235568,  1687227392579056368,  1688551416399622896,
    1689874755793267696,  1691197411467226608,  1692519384127638768,  1693840674479550960,  1695161283226918128,
    1696481211072606448,  1697800458718395632,  1699119026864981232,  1700436916211975920,  1701754127457913328,
    1703070661300248816,  1704386518435362288,  1705701699558560496,  1707016205364079344,  1708330036545085168,
    1709643193793678064,  1710955677800894192,  1712267489256706032,  1713578628850027504,  1714889097268713200,
    1716198895199562736,  1717508023328321776,  1718816482339684592,  1720124272917295856,  1721431395743753712,
    1722737851500610544,  1724043640868375792,  1725348764526518768,  1726653223153469680,  1727957017426621936,
    1729260148022335216,  1730562615615935728,  1731864420881720560,  1733165564492958192,  1734466047121890800,
    1735765869439736816,  1737065032116693232,  1738363535821936112,  1739661381223624688,  1740958568988902128,
    1742255099783898352,  1743550974273731056,  1744846193122508784,  1746140756993332464,  1747434666548297712,
    1748727922448496624,  1750020525354019824,  1751312475923958512,  1752603774816407024,  1753894422688463856,
    1755184420196233712,  1756473767994831088,  1757762466738380528,  1759050517080018928,  1760337919671898096,
    1761624675165186800,  1762910784210071792,  1764196247455760880,  1765481065550483952,  1766765239141495536,
    1768048768875076848,  1769331655396537072,  1770613899350216432,  1771895501379486448,  1773176462126753520,
    1774456782233460208
};

dec64 dec64_log(dec64 x)
{
    dec64 log10 = (23025850929940457 << 8) | (-16 & 255);
    int e = (signed char)x;
    x >>= 8;
    if (e == -128 || x <= 0)
        return DEC64_NULL;
    int e_ = (63 - __builtin_clzll(x))*77 >> 8;
    // by scaling coefficient by 10**-e_ bring x to 1
    // as close as possible; remember this scale in e
    x <<= 8;
    for(;;e_++) {
        x = (x & ~255) | (-e_ & 255);
        if (dec64_is_less(DEC64_ONE, x) == DEC64_FALSE)
            break;
    }
    e += e_;
    // log(1+a) = log((1+a)(1+b)) - log(1+b) = log(1+a+b+a*b) - log(1+b)
    // a = da + C; b=-C -> log(1+a) = log(1+da+C-C-C*(da+C)) - log(1-C) =
    // log(1-C*C+da*(1-C))-log(1-C) = log((1+da*(1-C)/(1-C*C))*(1-C*C)) - log(1-C) =
    // log(1+da/C') + log(C'), where C'=1+C
    dec64 y = dec64_add(x, -256);
    dec64 y_scaled = dec64_new(y>>8, (signed char)y+3);
    dec64 y_ = dec64_normal(dec64_floor(y_scaled));
    int64 tab_idx = y_ >> 8;
    tab_idx = tab_idx < LOGTAB_A ? LOGTAB_A : tab_idx > LOGTAB_B ? LOGTAB_B : tab_idx;
    dec64 C_ = (tab_idx << 8)|(-3 & 255);
    dec64 logC_ = logtab[tab_idx - LOGTAB_A];
    y = dec64_subtract(y, C_);
    y = dec64_divide(y, C_+1000*256);

    dec64 s = dec64_new(y>>8, (signed char)y), p = s;
    if (dec64_is_less(dec64_abs(logC_), DEC64_ONE) == DEC64_TRUE) {
        s = dec64_add(s, logC_);
        logC_ = 0;
    }
    y = dec64_neg(y);
    int i = 1, max_iters = 30;
    for (; i < max_iters; i++) {
        p = dec64_multiply(p, y);
        dec64 progress = dec64_fda(p, (i+1) << 8, s);
        if (dec64_is_equal(progress, s) == DEC64_TRUE)
            break;
        s = progress;
    }
    //printf("\nlog: taylor iters=%d\n", i);
    if (dec64_is_nan(s) == DEC64_TRUE)
        return DEC64_NULL;
    s = dec64_add(s, logC_);
    return dec64_fma(e << 8, log10, s);
}

/*
    The seed variables contain the random number generator's state.
    They can be set by dec64_seed.
*/

static uint64 seed_0 = D_E;
static uint64 seed_1 = D_2PI;

dec64 dec64_random() {
/*
    Return a number between 0 and 1 containing 16 randomy digits.
    It uses xorshift128+.
*/
    while (1) {
        uint64 s1 = seed_0;
        uint64 s0 = seed_1;
        s1 ^= s1 << 23;
        s1 ^= s0 ^ (s0 >> 5) ^ (s1 >> 18);
        seed_0 = s0;
        seed_1 = s1;
        uint64 mantissa = (s1 + s0) >> 10;
/*
    mantissa contains an integer between 0 and 18014398509481983.
    If it is less than or equal to 9999999999999999 then we are done.
*/
        if (mantissa <= 9999999999999999LL) {
            return dec64_new(mantissa, -16);
        }
    }
}

dec64 dec64_root(dec64 index, dec64 radicand) {
    dec64 result;
    index = dec64_normal(index);
    if (
        dec64_is_nan(radicand) == DEC64_TRUE
        || dec64_is_zero(index) == DEC64_TRUE
        || index < 0
        || dec64_exponent(index) != 0
        || (
            radicand < 0
            && (dec64_coefficient(index) & 1) == 0
        )
    ) {
        return DEC64_NAN;
    }
    if (dec64_is_zero(radicand) == DEC64_TRUE) {
        return DEC64_ZERO;
    }
    if (index == DEC64_ONE) {
        return radicand;
    }
    if (index == D_2) {
        return dec64_sqrt(radicand);
    }
    dec64 index_minus_one = dec64_add(DEC64_NEGATIVE_ONE, index);
    result = DEC64_ONE;
    dec64 prosult = DEC64_NAN;
    while (1) {
        dec64 progress = dec64_divide(
            dec64_add(
                dec64_multiply(result, index_minus_one),
                dec64_divide(
                    radicand,
                    dec64_raise(result, index_minus_one)
                )
            ),
            index
        );
        if (progress == result) {
            return result;
        }
        if (progress == prosult) {
            return dec64_divide(dec64_add(progress, result), D_2);
        }
        prosult = result;
        result = progress;
    }
}

void dec64_seed(uint64 part_0, uint64 part_1) {
/*
    Seed the dec64_random function. It takes any 128 bits as the seed value.
    The seed must contain at least one 1 bit.
*/
    seed_0 = part_0;
    seed_1 = part_1;
    if ((seed_0 | seed_1) == 0) {
        seed_1 = 1;
    }
}

dec64 dec64_sin(dec64 radians) {
    radians = dec64_modulo(radians, D_2PI);
    while (dec64_is_less(D_PI, radians) == DEC64_TRUE) {
        radians = dec64_subtract(radians, D_PI);
        radians = dec64_subtract(radians, D_PI);
    }
    while (dec64_is_less(radians, D_NPI) == DEC64_TRUE) {
        radians = dec64_add(radians, D_PI);
        radians = dec64_add(radians, D_PI);
    }
    int neg = 0;
    if (radians < 0) {
        radians = dec64_neg(radians);
        neg = -1;
    }
    if (dec64_is_less(D_HALF_PI, radians) == DEC64_TRUE) {
        radians = dec64_subtract(D_PI, radians);
    }
    dec64 result;
    if (radians == D_HALF_PI) {
        result = DEC64_ONE;
    } else {
        dec64 x2 = dec64_neg(dec64_multiply(radians, radians));
        int order = 1;
        dec64 term = radians;
        result = term;
        for(;order < 30;order++) {
            term = dec64_multiply(term, x2);
            term = dec64_divide(term, (order*2)*(order*2+1) << 8);
            dec64 progress = dec64_add(result, term);
            if (dec64_is_equal(progress, result) == DEC64_TRUE)
                break;
            result = progress;
        }
        //printf("order=%d\n", order);
    }
    if (neg) {
        result = dec64_neg(result);
    }
    return result;
}

dec64 dec64_sqrt(dec64 radicand) {
    if (dec64_is_nan(radicand) == DEC64_FALSE && radicand >= 0) {
        if (dec64_coefficient(radicand) == 0) {
            return DEC64_ZERO;
        }
        dec64 result = radicand;
        while (1) {
            dec64 progress = dec64_divide(
                dec64_add(
                    result,
                    dec64_divide(radicand, result)
                ),
                D_2
            );
            if (progress == result) {
                return result;
            }
            result = progress;
        }
        return result;
    } else {
        return DEC64_NAN;
    }
}

dec64 dec64_tan(dec64 radians) {
    return dec64_divide(
        dec64_sin(radians),
        dec64_cos(radians)
    );
}
